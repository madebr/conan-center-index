cmake_minimum_required(VERSION 3.1)
project(test_package)

include(${CMAKE_BINARY_DIR}/conanbuildinfo.cmake)
conan_basic_setup(TARGETS)

set(TLS_BACKENDS "" CACHE STRING "tls backends")
option(STATIC_BACKEND "backend is built statically")

foreach(TLS_BACKEND ${TLS_BACKENDS})
    set(_target ${PROJECT_NAME}_${TLS_BACKEND})
    add_executable(${_target} test_package.c)
    target_compile_definitions(${_target} PRIVATE BACKEND=${TLS_BACKEND} BACKEND_STRING="${TLS_BACKEND}")
    if(STATIC_BACKEND)
        target_compile_definitions(${_target} PRIVATE STATIC_BACKEND)
    endif()
    target_link_libraries(${_target} PRIVATE CONAN_PKG::glib)
    if(STATIC_BACKEND)
        target_link_libraries(${_target} PRIVATE CONAN_PKG::glib-networking)
    endif()
endforeach()
